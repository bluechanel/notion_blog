---
id: 34871ffa-62bc-4995-af00-6faaca757ac8
title: ğŸš å‘é‡æ£€ç´¢Chromaä½¿ç”¨å’ŒæœåŠ¡ç«¯dockeréƒ¨ç½²
slug: 34871ffa-62bc-4995-af00-6faaca757ac8
excerpt: ä»‹ç»å‘é‡æ£€ç´¢æ•°æ®åº“Chromaçš„æœåŠ¡ç«¯Dockeréƒ¨ç½²ï¼Œä»¥åŠå®¢æˆ·ç«¯åŸºæœ¬çš„ä½¿ç”¨
date: 2024-08-23
coverImage: /images/34871ffa-62bc-4995-af00-6faaca757ac8_0811b826df695886a5343f75e23b570b.png
lastUpdated: 2024-10-24T03:41:00.000Z
tags: blue:RAG,purple:Vector Store  
---

# éƒ¨ç½²

1. cloneé¡¹ç›®ï¼Œè‡ªè¡Œæ‰“åŒ…dockerï¼ˆdocker hub é•œåƒæ›´æ–°è½åï¼‰

    ```python
    git clone https://github.com/chroma-core/chroma.git
    ```

2. ç”ŸæˆéšæœºTokensä»¤ç‰Œ

    ```python
    import secrets
    
    # ç”Ÿæˆä¸€ä¸ªéšæœºçš„Tokenä»¤ç‰Œ
    token = secrets.token_urlsafe(32)  # ç”Ÿæˆä¸€ä¸ª32å­—èŠ‚çš„URLå®‰å…¨ä»¤ç‰Œ
    print(token)
    ```

3. åˆ›å»ºç¯å¢ƒå˜é‡`.chroma_env`æ–‡ä»¶ï¼Œå†™å…¥ä¸‹é¢çš„å†…å®¹

    ```python
    CHROMA_SERVER_AUTHN_CREDENTIALS="your-token"
    CHROMA_SERVER_AUTHN_PROVIDER="chromadb.auth.token_authn.TokenAuthenticationServerProvider"
    ```

4. å¯åŠ¨

    ```python
    docker compose up -d
    ```


# ä½¿ç”¨

1. è¿æ¥

    ```python
    import chromadb
    
    client = chromadb.HttpClient(host="127.0.0.1",
                                   port=8000,
                                   settings=chromadb.Settings(
                                       chroma_client_auth_provider="chromadb.auth.token_authn.TokenAuthClientProvider",
                                       chroma_client_auth_credentials="your_token"))
    ```

2. åˆ›å»ºcolletionï¼Œå¹¶ä½¿ç”¨å…¼å®¹langchainçš„embedding

    embedding éƒ¨ç½²è§[Embedding+Rerankéƒ¨ç½²](https://testblog.wileyzhang.com/19f605eee88980758d31f6b62294b77b#544a313750d84f1ca40c64488273a849) 


    ```python
    from chromadb.utils import embedding_functions
    from langchain_openai import OpenAIEmbeddings
    embedding = embedding_functions.create_langchain_embedding(OpenAIEmbeddings())
    collection = client.get_or_create_collection(name="test", embedding_function=embedding)
    ```

3. æ·»åŠ æ•°æ®

    ```python
    collection.add(ids=["1"],
                       documents="test",
                       metadatas={"author":"admin"})
    ```

4. æŸ¥è¯¢collectionæ•°æ®é‡

    ```python
    collection.count()
    ```

5. ç®€å•æŸ¥è¯¢collection

    ```python
    collection = client.get_collection("test", embedding_function=embedding)
    r = collection.query(query_texts="test", n_results=1)
    ```

